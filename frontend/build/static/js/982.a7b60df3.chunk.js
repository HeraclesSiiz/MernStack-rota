"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[982],{1982:function(e,t,n){n.r(t);var r=n(1413),a=n(5671),o=n(3144),i=n(7326),s=n(136),u=n(3668),l=n(2791),c=n(8687),f=n(3513),h=n(6367),p=n(8970),d=n(5828),v=n.n(d),m=(n(2831),n(4045)),g=n(9042),x=n(7392),j=n(4845),Z=n(184),w=function(e){(0,s.Z)(n,e);var t=(0,u.Z)(n);function n(e){var o;(0,a.Z)(this,n),(o=t.call(this,e)).onImportPatients=function(e){var t=e.target.files;if(t.length){var n=t[0];o.setState((0,r.Z)((0,r.Z)({},o.state),{},{file:n}))}},o.submit=function(){var e=(0,i.Z)(o);if(o.state.file){var t=new FileReader;t.onload=function(t){var n=(0,m.ij)(t.target.result),r=n.SheetNames,a=r.indexOf("Revenue");if(-1!=a){var o=m.P6.sheet_to_json(n.Sheets[r[a]]);g.Z.post("patient/import",{importData:o}).then((function(t){var n=t.data.notFound,r=t.data;0!=n.length&&v().warning("Not Found These Patients:"+n.join(",")),e.props.getImportData(r)})).catch((function(e){}))}},t.readAsArrayBuffer(o.state.file)}else v().info("Please select import file!")},o.onChangeYear=function(e){o.setState((0,r.Z)((0,r.Z)({},o.state),{},{selYear:e.target.value}))};var s=(new Date).getFullYear();return o.state={selYear:s,file:""},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){}},{key:"getTotals",value:function(e,t){var n=0;return e.forEach((function(e){n+=e[t]?e[t]:0})),n}},{key:"swap",value:function(e){var t=[];for(var n in e)t[e[n]]=n;return t}},{key:"render",value:function(){var e=this,t=this.state.selYear,n=this.props.basic,r=this.props.basic.user;r.role||0!==r.role||(j.Z.push("/"),j.Z.go("/"));var a=n.monthNames,o=(this.swap(a),[]);o.push({name:"Revenue",center:!0,wrap:!0,selector:function(e){return e.patient}});var i=function(e){o.push({name:e,center:!0,wrap:!0,width:"75px",selector:function(t){return t[e]?t[e].toLocaleString("en"):""}})};for(var s in a)i(s);o.push({name:"Total",center:!0,wrap:!0,selector:function(e){return e.total?e.total.toLocaleString("en"):""}});var u=[];n.patients.map((function(e){var n=[],r=0;if(n.patient=e.name,void 0!=e.revenue)for(var a in e.revenue){if(a.slice(4,6)==t%100)n[a.slice(0,3)]=e.revenue[a],r+=e.revenue[a]}n.total=r,u.push(n)}));var l={patient:"Total"};for(var c in a)l[c]=this.getTotals(u,c);l.total=this.getTotals(u,"total"),u.push(l);return u.sort((function(e,t){return e.name>t.name?1:t.name>e.name?-1:0})),(0,Z.jsxs)(h.L5,{children:[(0,Z.jsx)("div",{className:"pt-5 text-center text-dark",children:(0,Z.jsx)("h1",{className:"mt-3",children:"REVENUE"})}),(0,Z.jsxs)(h.uZ,{className:" align-items-center justify-content-center",children:[(0,Z.jsx)(h.TK,{md:"2",children:(0,Z.jsx)(p.Z.Group,{children:(0,Z.jsx)(p.Z.Control,{type:"number",value:t,placeholder:"Year",onChange:function(t){return e.onChangeYear(t)}})})}),(0,Z.jsx)(h.TK,{md:"3",children:(0,Z.jsx)(p.Z.Group,{controlId:"ImageInput",children:(0,Z.jsx)(p.Z.Control,{type:"file",accept:".xlsx",onChange:function(t){return e.onImportPatients(t,e)}})})}),(0,Z.jsx)(h.TK,{md:"2",children:(0,Z.jsx)(h.$v,{outline:!0,rounded:!0,color:"success",onClick:function(){return e.submit()},children:"SUBMIT"})})]}),(0,Z.jsx)(h.uZ,{className:"mt-2",children:(0,Z.jsx)(f.ZP,{columns:o,data:u,fixedHeader:!0,striped:!0,conditionalRowStyles:[{when:function(e){return"total"==e.patient},style:function(e){return{backgroundColor:"rgb(160,160,160)"}}}],fixedHeaderScrollHeight:"60vh",pagination:!0})})]})}}]),n}(l.Component);t.default=(0,c.$j)((function(e){return{basic:e.BasicData}}),(function(e){return{getImportData:function(t){return e((0,x.iC)(t))}}}))(w)}}]);
//# sourceMappingURL=982.a7b60df3.chunk.js.map