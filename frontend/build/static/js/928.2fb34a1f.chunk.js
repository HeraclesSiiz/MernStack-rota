"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[928],{2928:function(e,t,a){a.r(t);var n=a(2982),r=a(7762),o=a(1413),l=a(5671),s=a(3144),i=a(136),c=a(8505),u=a(2791),h=a(8687),d=a(3513),v=a(6367),p=a(4373),m=a(6511),f=a(7873),g=a(2576),y=a(8970),w=a(184),k=function(e){(0,i.Z)(a,e);var t=(0,c.Z)(a);function a(e){var n;(0,l.Z)(this,a),(n=t.call(this,e)).onChangeYear=function(e){n.setState((0,o.Z)((0,o.Z)({},n.state),{},{selYear:e.target.value}))},n.onChangeMonth=function(e){n.setState((0,o.Z)((0,o.Z)({},n.state),{},{selMonth:e.target.value}))},n.onChangeDesignation=function(e){n.setState((0,o.Z)((0,o.Z)({},n.state),{},{selDesignation:e.target.value}))};var r=(new Date).getFullYear();return n.state={selYear:r,selMonth:"00",selDesignation:-1},n}return(0,s.Z)(a,[{key:"componentDidMount",value:function(){}},{key:"swap",value:function(e){var t=[];for(var a in e)t[e[a]]=a;return t}},{key:"getTotals",value:function(e,t){var a=0;return e.forEach((function(e){a+=e[t]})),a}},{key:"render",value:function(){var e=this,t=this.state,a=t.selYear,o=t.selMonth,l=t.selDesignation,s=this.props.basic,i=s.monthNames,c=this.swap(i),u=Object.keys(i),h=Object.values(i),k=u.map((function(e,t){return(0,w.jsx)("option",{value:h[t],children:e})})),b=[];if("00"!=o)b.push({name:"ID",center:!0,wrap:!0,width:"80px",selector:function(e){return e.code}},{name:"Name",center:!0,wrap:!0,width:"120px",selector:function(e){return e.name}},{name:"Designation",center:!0,wrap:!0,width:"120px",selector:function(e){return e.designation}},{name:"Month(d)",center:!0,wrap:!0,width:"80px",selector:function(e){return e.monthdays}},{name:"Worked(d)",center:!0,wrap:!0,width:"80px",selector:function(e){return e.workeddays}},{name:"Worked(h)",center:!0,wrap:!0,width:"80px",selector:function(e){return e.totalhoursworked}},{name:"NormalOver(h)",center:!0,wrap:!0,width:"120px",selector:function(e){return e.normalovertimehours}},{name:"HolidayOver(h)",center:!0,wrap:!0,width:"120px",selector:function(e){return e.holidayovertimehours}},{name:"GrossSalary",center:!0,wrap:!0,width:"120px",selector:function(e){return e.grosssalary}},{name:"NormalOvertime",center:!0,wrap:!0,width:"120px",selector:function(e){return e.normalovertime}},{name:"HolidayOvertime",center:!0,wrap:!0,width:"150px",selector:function(e){return e.holidayovertime}});else{b.push({name:"Nurse",center:!0,wrap:!0,selector:function(e){return e.nurse}}),b.push({name:"Designation",center:!0,wrap:!0,selector:function(e){return e.designation}});var x=function(e){b.push({name:e,center:!0,wrap:!0,width:"70px",cell:function(t){return(0,w.jsx)(f.Z,{placement:"top",overlay:(0,w.jsx)(g.Z,{className:"display-linebreak",style:{position:"fixed"},children:t[e+"comment"]}),children:(0,w.jsx)("p",{className:"payroll hover",children:t[e]?t[e].toLocaleString("en"):0})},t._id)}})};for(var D in i)x(D)}b.push({name:"Total",center:!0,wrap:!0,width:"80px",selector:function(e){return e.total?e.total.toLocaleString("en"):0}});var j=[],Z=[],N=s.holidays,C=[];N.map((function(e){var t=c[e.slice(0,2)];void 0==C[t]&&(C[t]=[]),C[t].push(a+"-"+e)}));var M=[];for(var S in c)for(var O=new Date(a,S,0).getDate(),T=new Date(a+"-"+S+"-01").getDay(),Y=T=0==T?1:7-T+1;Y<O;Y+=7){var I=Y>9?Y:"0"+Y,F=c[S];void 0==M[F]&&(M[F]=[]),M[F].push(a+"-"+S+"-"+I)}if(a<=(new Date).getFullYear()){s.nurses.map((function(e){var t,s=parseFloat(15*e.basic_allowances/365/8),u=parseFloat(18*e.basic_allowances/365/8);if("-1"==l||parseInt(e.level)==l){var h=e.basic_allowances+e.housing_allowances+e.other_allowances;t=parseFloat(12*h/365);var d,v="basic:"+e.basic_allowances+"\nhousing:"+e.housing_allowances+"\nother:"+e.other_allowances,p=e.leave?e.leave:[],m=[],f=(0,r.Z)(p);try{for(f.s();!(d=f.n()).done;)for(var g=d.value,y=new Date(g.from),w=new Date(g.to),k=y;k<=w;){var b=k.getFullYear(),x=k.getMonth()+1>9?k.getMonth()+1:"0"+(k.getMonth()+1),D=k.getDate()>9?k.getDate():"0"+k.getDate();if(b==a){var Z=c[x];void 0==m[Z]&&(m[Z]=[]),m[Z].push(b+"-"+x+"-"+D)}k.setDate(k.getDate()+1)}}catch(U){f.e(U)}finally{f.f()}var N=e.rota,S=[],O=[],T=[],Y=0;N.map((function(e){if(e.date.startsWith(a)){var t=c[[e.date.slice(5,7)]];i[t]==o&&(T.push(e.date),Y+=e.hour),void 0==S[t]?S[t]=e.hour:S[t]+=e.hour,C[t]&&C[t].includes(e.date)&&(void 0==O[t]?O[t]=e.hour:O[t]+=e.hour)}}));var I,F,_,A,H,J,L,R=[],W=[],K=[],G=[];for(var E in i){var P=new Date(a,i[E],0).getDate();if(i[E]==o&&(I=P),void 0==m[E]&&(m[E]=[]),void 0==C[E]&&(C[E]=[]),void 0==M[E]&&(M[E]=[]),K[E]=[].concat((0,n.Z)(m[E]),(0,n.Z)(C[E]),(0,n.Z)(M[E])),K[E]=(0,n.Z)(new Set(K[E])),G[E]=8*(P-K[E].length),void 0==S[E]&&(S[E]=0),G[E]<S[E]){var B=S[E]-G[E],V=0;void 0!=O[E]&&(B<=O[E]?(V=B,B=0):(B-=O[E],V=O[E])),R[E]=h+parseInt(s*B+u*V),W[E]=v+"\novertime:"+B+"hours\nholiday overtime:"+V+"hours",i[E]==o&&(F=B,_=V,H=s*B,J=u*V,A=h,L=R[E])}else{if(R[E]=h,W[E]=v,a==parseInt(e.date.slice(0,4))){var $=e.date;i[E]<$.slice(5,7)?R[E]=0:i[E]==$.slice(5,7)&&(R[E]=h-parseInt(t*parseInt($.slice(8,10)-1)))}else a<parseInt(e.date.slice(0,4))&&(R[E]=0);i[E]==o&&(F=0,_=0,H=0,J=0,A=h,L=R[E])}}var q={};if(q.nurse=e.name,q.designation=0==e.level?"Registered":"Assistant","00"==o){var z=0;for(var Q in i)a==(new Date).getFullYear()?parseInt(i[Q])<=(new Date).getMonth()+1?(q[Q]=R[Q],q[Q+"comment"]=W[Q],z+=q[Q]):q[Q]=0:a<(new Date).getFullYear()&&(q[Q]=R[Q],q[Q+"comment"]=W[Q],z+=q[Q]);q.total=z,j.push(q)}else T=(0,n.Z)(new Set(T)),q.code=e.code,q.name=e.name,q.designation=0==e.level?"Registered":"Assistant",q.monthdays=I,q.workeddays=T.length,q.totalhoursworked=Y,q.normalovertimehours=F,q.holidayovertimehours=_,q.grosssalary=A,q.normalovertime=parseInt(H),q.holidayovertime=parseInt(J),q.total=L,j.push(q)}}));var _={nurse:"Total",code:"Total"};if("00"!=o)for(var A in Z=[{label:"ID",key:"code"},{label:"Name",key:"name"},{label:"Designation",key:"designation"},{label:"Worked Days",key:"workeddays"},{label:"Worked Hours",key:"totalhoursworked"},{label:"NormalOver(h)",key:"normalovertimehours"},{label:"HolidayOver(h)",key:"holidayovertimehours"},{label:"GrossSalary",key:"grosssalary"},{label:"NormalOvertime",key:"normalovertime"},{label:"HolidayOvertime",key:"holidayovertime"},{label:"Total",key:"total"}],i);else for(var H in i)_[H]=this.getTotals(j,H),_.total=this.getTotals(j,"total"),Z=[{label:"Nurse",key:"nurse"},{label:"Designation",key:"designation"},{label:"Jan",key:"Jan"},{label:"Feb",key:"Feb"},{label:"Mar",key:"Mar"},{label:"Apr",key:"Apr"},{label:"May",key:"May"},{label:"Jun",key:"Jun"},{label:"Jul",key:"Jul"},{label:"Aug",key:"Aug"},{label:"Sep",key:"Sep"},{label:"Oct",key:"Oct"},{label:"Nov",key:"Nov"},{label:"Dec",key:"Dec"},{label:"Total",key:"total"}]}return(0,w.jsxs)(v.L5,{children:[(0,w.jsx)("div",{className:"pt-5 text-center text-dark",children:(0,w.jsx)("h1",{className:"mt-3",children:"PAY ROLL"})}),(0,w.jsxs)(v.uZ,{className:" align-items-center justify-content-center",children:[(0,w.jsx)(v.TK,{md:"2",children:(0,w.jsxs)(y.Z.Select,{"aria-label":"select",value:l,onChange:function(t){return e.onChangeDesignation(t)},children:[(0,w.jsx)("option",{value:"-1",children:"All"}),(0,w.jsx)("option",{value:"0",children:"Registered"}),(0,w.jsx)("option",{value:"1",children:"Assistant"})]})}),(0,w.jsx)(v.TK,{md:"2",children:(0,w.jsx)(y.Z.Group,{children:(0,w.jsx)(y.Z.Control,{type:"number",value:a,placeholder:"Year",onChange:function(t){return e.onChangeYear(t)}})})}),(0,w.jsx)(v.TK,{md:"2",children:(0,w.jsxs)(y.Z.Select,{"aria-label":"select",value:o,onChange:function(t){return e.onChangeMonth(t)},children:[(0,w.jsx)("option",{value:"00",children:"Month"}),k]})}),(0,w.jsx)(v.TK,{md:"2",children:(0,w.jsxs)(m.CSVLink,{data:j,headers:Z,filename:"payroll.csv",className:"btn btn-success ",target:"_blank",children:[(0,w.jsx)(p.Cb8,{}),"Export"]})})]}),(0,w.jsx)(v.uZ,{className:"mt-2",children:(0,w.jsx)(d.ZP,{columns:b,data:j,fixedHeader:!0,striped:!0,conditionalRowStyles:[{when:function(e){return"Total"==e.designation},style:function(e){return{backgroundColor:"rgb(160,160,160)"}}}],fixedHeaderScrollHeight:"60vh",pagination:!0})})]})}}]),a}(u.Component);t.default=(0,h.$j)((function(e){return{basic:e.BasicData}}),null)(k)}}]);
//# sourceMappingURL=928.2fb34a1f.chunk.js.map