"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[453],{4453:function(e,t,n){n.r(t);var a=n(4942),r=n(1413),s=n(5671),l=n(3144),o=n(7326),i=n(136),c=n(8505),u=n(2791),d=n(4569),v=n.n(d),h=n(8687),m=n(3513),f=n(6367),p=n(6511),x=n(4373),y=n(5795),j=n(5047),_=n(6355),Z=n(5828),g=n.n(Z),C=(n(2831),n(7392)),L=n(184),S=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var l;(0,s.Z)(this,n),(l=t.call(this,e)).setDate=function(e,t){l.setState((0,r.Z)((0,r.Z)({},l.state),{},(0,a.Z)({},e,t.target.value)))},l.setModalDate=function(e,t){l.setState((0,r.Z)((0,r.Z)({},l.state),{},{modal:(0,r.Z)((0,r.Z)({},l.state.modal),{},(0,a.Z)({},e,t.target.value))}))},l.filterChange=function(e){l.setState((0,r.Z)((0,r.Z)({},l.state),{},{selFilter:e.target.value}))},l.nurseSelect=function(e){l.setState((0,r.Z)((0,r.Z)({},l.state),{},{selNurse:e.target.value}))},l.onChangeNurse=function(e){l.setState((0,r.Z)((0,r.Z)({},l.state),{},{selNurse:e.target.value}))},l.onChangeType=function(e){l.setState((0,r.Z)((0,r.Z)({},l.state),{},{selType:e.target.value}))},l.onChangeView=function(e,t){l.setState((0,r.Z)((0,r.Z)({},l.state),{},(0,a.Z)({},e,t.target.value)))},l.addLeave=function(){var e=(0,o.Z)(l),t=l.state,n=t.selNurse,a=t.selType,r=t.from,s=t.to;0==n?g().info("Please select nurse!"):(l.setState({selNurse:0}),v().post("leave/add",{nurse_id:n,type:a,from:r,to:s}).then((function(t){g().info("Add LeaveDays Success!"),e.props.getLeave(t.data)})).catch((function(e){})))},l.leaveModal=function(e,t){e?l.setState((0,r.Z)((0,r.Z)({},l.state),{},{isOpen:e,modal:{nurse_id:t.nurse_id,leave_id:t.leave_id,type:t.type,from:t.leave_start,to:t.leave_end}})):l.setState((0,r.Z)((0,r.Z)({},l.state),{},{isOpen:e}))},l.editConfirmLeave=function(){var e=(0,o.Z)(l);l.setState({isOpen:!1}),v().post("leave/edit",(0,r.Z)({},l.state.modal)).then((function(t){g().info("Modify LeaveDays Success!"),e.props.getLeave(t.data)})).catch((function(e){}))},l.removeLeave=function(e){var t=(0,o.Z)(l);v().post("leave/remove",{nurse_id:e.nurse_id,leave_id:e.leave_id}).then((function(e){g().info("Remove LeaveDays Success!"),t.props.getLeave(e.data)})).catch((function(e){}))};var i=new Date,c=i.getFullYear(),u=i.getMonth()+1>9?i.getMonth()+1:"0"+(i.getMonth()+1),d=i.getDate()>9?i.getDate():"0"+i.getDate();return l.state={selView:1,selYear:c,selMonth:u,from:c+"-"+u+"-"+d,to:c+"-"+u+"-"+d,selFilter:"",selNurse:0,selType:0,isOpen:!1,modal:{nurse_id:"",leave_id:"",type:"",from:"",to:""}},l}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){}},{key:"getLeaveType",value:function(e){return 1==e.type?e.leave_type="Annual Leave":2==e.type?e.leave_type="Sick Leave":3==e.type?e.leave_type="Maternity leave":4==e.type&&(e.leave_type="Other Leave"),e.leave_type}},{key:"render",value:function(){var e=this,t=this.state,n=t.from,a=t.to,r=t.selNurse,s=t.selType,l=t.modal,o=t.isOpen,i=t.selView,c=t.selYear,u=t.selMonth,d=(t.selFilter,this.props.basic),v=[];v.push({name:"No",center:!0,wrap:!0,selector:function(e){return e.no}},{name:"Image",center:!0,wrap:!0,width:"70px",cell:function(e){return(0,L.jsx)("img",{src:e.image,style:{width:"30px",height:"40px"}})}},{name:"Staff ID",center:!0,wrap:!0,selector:function(e){return e.nurse_short_id}},{name:"Staff Name",center:!0,selector:function(e){return e.name}}),1==i?v.push({name:"Leave Type",center:!0,selector:function(e){return e.leave_type}},{name:"Leave Start",center:!0,wrap:!0,selector:function(e){return e.leave_start}},{name:"Leave End",center:!0,selector:function(e){return e.leave_end}}):v.push({name:"Leave Periods",center:!0,wrap:!0,width:"300px",selector:function(e){return e.leave_periods}}),v.push({name:"Leave Days",center:!0,wrap:!0,selector:function(e){return e.leave_days}},{name:"Daily Hours",center:!0,wrap:!0,selector:function(e){return e.daily_hours}},{name:"Leave Hours",center:!0,wrap:!0,selector:function(e){return e.leave_hours}}),1==i&&v.push({name:"Action",center:!0,wrap:!0,cell:function(t){return[(0,L.jsxs)(f.Ff,{children:[(0,L.jsx)(f.$v,{outline:!0,color:"success",size:"sm",className:"my-1 ms-1",onClick:function(){return e.leaveModal(!0,t)},children:(0,L.jsx)(_.fmQ,{})}),(0,L.jsx)(f.$v,{outline:!0,color:"success",size:"sm",className:"my-1 me-1",onClick:function(){return e.removeLeave(t)},children:(0,L.jsx)(_.Xm5,{})})]},t.leave_id)]}});var h=[],Z=0;d.nurses.map((function(t){var n=0,a=[];t.leave.map((function(r){var s=c+"-"+u,l=new Date(c,u,0).getDate();if(r.from.startsWith(s)||r.to.startsWith(s)){var o=new Date(r.from),d=new Date(r.to),v=Math.ceil((d-o)/864e5)+1;2==i&&(r.from.startsWith(s)?r.to.startsWith(s)?a.push("("+parseInt(r.from.slice(8))+"~"+parseInt(r.to.slice(8))+")"):(v=Math.ceil((new Date(c+"-"+u+"-"+l)-o)/864e5)+1,a.push("("+parseInt(r.from.slice(8))+"~"+l+")")):(v=parseInt(r.to.slice(8,10)),a.push("(1~"+parseInt(r.to.slice(8))+")")),n+=v),1==i&&(Z++,h.push({no:Z,image:t.image,nurse_id:t._id,nurse_short_id:t._id.slice(20),name:t.name,leave_type:e.getLeaveType(r),leave_id:r.leave_id,leave_start:r.from,leave_end:r.to,leave_days:v,daily_hours:8,leave_hours:8*v}))}})),2==i&&0!=n&&(Z++,h.push({no:Z,image:t.image,nurse_id:t._id,nurse_short_id:t._id.slice(20),name:t.name,leave_periods:a.join(","),leave_days:n,daily_hours:8,leave_hours:8*n}))}));var g=d.monthNames,C=Object.keys(g),S=Object.values(g),w=C.map((function(e,t){return(0,L.jsx)("option",{value:S[t],children:e})}));return(0,L.jsxs)(f.L5,{children:[(0,L.jsx)("div",{className:"pt-5 text-center text-dark",children:(0,L.jsx)("h1",{className:"mt-3",children:"LEAVE DAYS"})}),(0,L.jsxs)(f.uZ,{className:" align-items-center justify-content-center",children:[(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsxs)(y.Z.Select,{"aria-label":"nurse select",required:!0,value:r,onChange:function(t){return e.onChangeNurse(t)},children:[(0,L.jsx)("option",{value:"0",children:"Select Nurse"}),d.nurses.map((function(e,t){return(0,L.jsx)("option",{value:e._id,children:e.name},t)}))]})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsxs)(y.Z.Select,{"aria-label":"nurse select",value:s,onChange:function(t){return e.onChangeType(t)},children:[(0,L.jsx)("option",{value:"",children:"Select Here"}),(0,L.jsx)("option",{value:"1",children:"Annual leave"}),(0,L.jsx)("option",{value:"2",children:"sick leave"}),(0,L.jsx)("option",{value:"3",children:"Maternity leave"}),(0,L.jsx)("option",{value:"4",children:"Other Leave"})]})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsx)(y.Z.Control,{type:"date",value:n,max:a,onChange:function(t){return e.setDate("from",t)}})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsx)(y.Z.Control,{type:"date",value:a,min:n,onChange:function(t){return e.setDate("to",t)}})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(f.$v,{outline:!0,rounded:!0,color:"success",onClick:function(){return e.addLeave()},children:"Add Leave"})})]}),(0,L.jsxs)(f.uZ,{className:"mt-3 align-items-center justify-content-center",children:[(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsxs)(y.Z.Select,{"aria-label":"nurse select",value:i,onChange:function(t){return e.onChangeView("selView",t)},children:[(0,L.jsx)("option",{value:"1",children:"View Per Record"}),(0,L.jsx)("option",{value:"2",children:"View Per Nurse"})]})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Group,{children:(0,L.jsx)(y.Z.Control,{type:"number",value:c,min:2e3,onChange:function(t){return e.onChangeView("selYear",t)}})})}),(0,L.jsx)(f.TK,{md:"2",children:(0,L.jsx)(y.Z.Select,{"aria-label":"select",value:u,onChange:function(t){return e.onChangeView("selMonth",t)},children:w})}),(0,L.jsx)(f.TK,{md:"3",className:"float-right",children:(0,L.jsxs)(p.CSVLink,{headers:[{label:"No",key:"no"},{label:"Staff ID",key:"nurse_short_id"},{label:"Staff Name",key:"name"},{label:"Leave Type",key:"leave_type"},{label:"Leave Start",key:"leave_start"},{label:"Leave End",key:"leave_end"},{label:"Leave Days",key:"leave_days"},{label:"Daily Hours",key:"daily_hours"},{label:"Leave Hours",key:"leave_hours"}],data:h,filename:"leavedays.csv",className:"btn btn-success ",target:"_blank",children:[(0,L.jsx)(x.Cb8,{}),"Export"]})})]}),(0,L.jsx)(f.uZ,{className:"mt-2",children:(0,L.jsx)(m.ZP,{columns:v,data:h,fixedHeader:!0,fixedHeaderScrollHeight:"60vh"})}),(0,L.jsxs)(j.Z,{show:o,size:"sm","aria-labelledby":"contained-modal-title-vcenter",centered:!0,onHide:function(){return e.leaveModal(!1)},children:[(0,L.jsx)(j.Z.Header,{closeButton:!0,children:(0,L.jsx)(j.Z.Title,{children:"Leave Modify"})}),(0,L.jsxs)(j.Z.Body,{children:[(0,L.jsx)(f.uZ,{children:(0,L.jsx)(f.TK,{children:(0,L.jsx)(y.Z.Control,{type:"date",value:l.from,max:l.to,onChange:function(t){return e.setModalDate("from",t)}})})}),(0,L.jsx)(f.uZ,{className:"mt-2",children:(0,L.jsx)(f.TK,{children:(0,L.jsx)(y.Z.Control,{type:"date",value:l.to,min:l.from,onChange:function(t){return e.setModalDate("to",t)}})})})]}),(0,L.jsxs)(j.Z.Footer,{children:[(0,L.jsx)(f.$v,{color:"secondary",onClick:function(){return e.leaveModal(!1)},children:"Close"}),(0,L.jsx)(f.$v,{color:"success",onClick:function(){return e.editConfirmLeave()},children:"Save"})]})]})]})}}]),n}(u.Component);t.default=(0,h.$j)((function(e){return{basic:e.BasicData}}),(function(e){return{getLeave:function(t){return e((0,C.ZY)(t))}}}))(S)}}]);
//# sourceMappingURL=453.3bfec574.chunk.js.map