"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[900],{8900:function(e,a,i){i.r(a);var r=i(2982),s=i(7762),t=i(1413),l=i(5671),n=i(3144),o=i(136),d=i(3668),h=i(2791),c=(i(4278),i(8687)),u=i(6367),v=i(8970),m=i(3076),g=i(184),x=function(e){(0,o.Z)(i,e);var a=(0,d.Z)(i);function i(e){var r;(0,l.Z)(this,i),(r=a.call(this,e)).onChangeYear=function(e){r.setState((0,t.Z)((0,t.Z)({},r.state),{},{selYear:e.target.value}))},r.onChangeMonth=function(e){r.setState((0,t.Z)((0,t.Z)({},r.state),{},{selMonth:e.target.value}))};var s=new Date,n=s.getFullYear(),o=s.getMonth()+1>9?s.getMonth()+1:"0"+(s.getMonth()+1);return r.state={selYear:n,selMonth:o},r}return(0,n.Z)(i,[{key:"componentDidMount",value:function(){}},{key:"swap",value:function(e){var a=[];for(var i in e)a[e[i]]=i;return a}},{key:"render",value:function(){var e=this,a=this.state,i=a.selYear,t=a.selMonth,l=this.props.basic,n=[{members:0,available:0,assigned:0,overtime:0,utilization:0},{members:0,available:0,assigned:0,overtime:0,utilization:0},{members:0,available:0,assigned:0,overtime:0,utilization:0}],o=l.monthNames,d=this.swap(o),h=d[t],c=Object.keys(o),x=Object.values(o),p=c.map((function(e,a){return(0,g.jsx)("option",{value:x[a],children:e},a)})),b=new Date(i,t,0).getDate(),j=i+"-"+t+"-01",f=i+"-"+t+"-"+b,C=l.holidays,w=[],F=[];C.map((function(e){var a=d[e.slice(0,2)];void 0==F[a]&&(F[a]=[]),F[a].push(i+"-"+e),parseInt(e.slice(0,2))==t&&w.push(i+"-"+e)}));var Z=[];for(var k in d)for(var D=new Date(i,k,0).getDate(),M=new Date(i+"-"+k+"-01").getDay(),y=M=0==M?1:7-M+1;y<D;y+=7){var B=y>9?y:"0"+y,T=d[k];void 0==Z[T]&&(Z[T]=[]),Z[T].push(i+"-"+k+"-"+B)}var K=[],Y=[],_=[],z=[],R=[];z[0]=[],z[1]=[],z[2]=[],R[0]=[],R[1]=[],R[2]=[],l.nurses.map((function(e){var a=e.basic_allowances+e.housing_allowances+e.other_allowances,l=e.level;n[l].members++,n[2].members++;var c=e.rota,u=[],v=[];(c=c.filter((function(e){return e.date>=j&&e.date<=f||e.date.startsWith(i)}))).map((function(a){if(a.date>=j&&a.date<=f&&(n[l].assigned+=1*a.hour,n[2].assigned+=1*a.hour),a.date.startsWith(i)){var r=parseInt(a.date.slice(5,7)),s=d[[a.date.slice(5,7)]],o=parseInt(a.date.slice(8,10));void 0==u[s]?u[s]=a.hour:u[s]+=a.hour,void 0==z[l][r]?z[l][r]=a.hour:z[l][r]+=a.hour,void 0==z[2][r]?z[2][r]=a.hour:z[2][r]+=a.hour,a.date.startsWith(i+"-"+t)&&(void 0==R[l][o]?R[l][o]=a.hour:R[l][o]+=a.hour,void 0==R[2][o]?R[2][o]=a.hour:R[2][o]+=a.hour),void 0!=F[s]&&F[s].includes(a.date)&&(void 0==v[s]?v[s]=a.hour:v[s]+=a.hour),a.date.slice(5,7)==t&&(void 0==Y[a.patient_id]&&(Y[a.patient_id]=[]),void 0==Y[a.patient_id][e._id]?Y[a.patient_id][e._id]=a.hour:Y[a.patient_id][e._id]+=a.hour)}}));var m,g=e.leave,x=[],p=(0,s.Z)(g);try{for(p.s();!(m=p.n()).done;)for(var C=m.value,k=new Date(C.from),D=new Date(C.to),M=k;M<=D;){var y=M.getFullYear(),B=M.getMonth()+1>9?M.getMonth()+1:"0"+(M.getMonth()+1),T=M.getDate()>9?M.getDate():"0"+M.getDate();if(y==i&&B==t&&x.push(y+"-"+B+"-"+T),y==i){var H=d[B];void 0==x[H]&&(x[H]=[]),x[H].push(y+"-"+B+"-"+T)}M.setDate(M.getDate()+1)}}catch($){p.e($)}finally{p.f()}var N=[].concat(x,w,(0,r.Z)(Z[h]));N=(0,r.Z)(new Set(N)),n[l].available+=8*(b-N.length),n[2].available+=8*(b-N.length);var I=[],A=[];for(var P in o){var Q=new Date(i,o[P],0).getDate();if(void 0==x[P]&&(x[P]=[]),void 0==F[P]&&(F[P]=[]),void 0==Z[P]&&(Z[P]=[]),I[P]=[].concat((0,r.Z)(x[P]),(0,r.Z)(F[P]),(0,r.Z)(Z[P])),I[P]=(0,r.Z)(new Set(I[P])),A[P]=8*(Q-I[P].length),void 0==u[P]&&(u[P]=0),void 0==v[P]&&(v[P]=0),void 0==K[P]&&(K[P]=0),u[P]){var S=parseFloat(15*e.basic_allowances/365/8),W=parseFloat(18*e.basic_allowances/365/8),O=parseFloat(12*a/365);if(A[P]<u[P]){var G=u[P]-A[P],L=0;void 0!=v[P]&&(G<=v[P]?(L=G,G=0):(G-=v[P],L=v[P])),a+=parseInt(S*G+W*L)}if(i==parseInt(e.date.slice(0,4))){var U=e.date;o[P]<U.slice(5,7)?a=0:o[P]==U.slice(5,7)&&(a-=parseInt(O*(parseInt(U.slice(8,10))-1)))}else i<parseInt(e.date.slice(0,4))&&(a=0);K[P]+=a,o[P]==t&&(_[e._id]=parseFloat(a/u[P]))}}})),n.map((function(e){e.overtime=1*e.assigned-1*e.available,1*e.available==0?e.utilization=0:e.utilization=parseInt(1*e.assigned/e.available*1*100)}));var H=[];l.patients.map((function(e){for(var a in e.revenue)if(a.slice(4,6)==i%100){var r=a.slice(0,3);void 0==H[r]?H[r]=e.revenue[a]:H[r]+=e.revenue[a]}}));var N=[],I=[],A=[];for(var P in o)void 0==H[P]&&(H[P]=0),void 0==K[P]&&(K[P]=0),I.push(H[P]),A.push(K[P]),N.push(H[P]-K[P]);for(var Q=[],S=0;S<3;S++){for(var W=1;W<=b;W++)0==S&&Q.push(W),void 0==R[S][W]&&(R[S][W]=0),R[S][W]=parseFloat(R[S][W]/n[S].members).toFixed(2);for(var O=1;O<=12;O++)void 0==z[S][O]&&(z[S][O]=0),z[S][O]=parseFloat(z[S][O]/n[S].members).toFixed(2);R[S].splice(0,1),z[S].splice(0,1)}return(0,g.jsxs)(u.L5,{children:[(0,g.jsxs)(u.uZ,{className:"pt-5 mt-3 align-items-center justify-content-center",children:[(0,g.jsx)(u.TK,{md:"2",children:(0,g.jsx)(v.Z.Group,{children:(0,g.jsx)(v.Z.Control,{type:"number",value:i,placeholder:"Year",min:2022,max:(new Date).getFullYear()+1,onChange:function(a){return e.onChangeYear(a)}})})}),(0,g.jsx)(u.TK,{md:"2",children:(0,g.jsx)(v.Z.Group,{children:(0,g.jsx)(v.Z.Select,{"aria-label":"select",value:t,onChange:function(a){return e.onChangeMonth(a)},children:p})})})]}),(0,g.jsxs)(u.uZ,{className:"mt-3",children:[(0,g.jsx)(u.TK,{children:(0,g.jsxs)(u.Yl,{children:[(0,g.jsx)(u.PH,{src:"1.webp",alt:"...",position:"top"}),(0,g.jsxs)(u.H7,{children:[(0,g.jsx)(u.QM,{children:"Members"}),(0,g.jsx)(u.g9,{className:"mb-1",height:"15",children:(0,g.jsx)(u.F5,{width:"100",valuemin:0,valuemax:100,children:n[2].members})}),(0,g.jsxs)(u.g9,{height:"15",children:[(0,g.jsx)(u.F5,{bgColor:"success",width:0==n[2].members?0:n[0].members/n[2].members*100,valuemin:0,valuemax:100,children:n[0].members}),(0,g.jsx)(u.F5,{bgColor:"info",width:0==n[2].members?0:n[1].members/n[2].members*100,valuemin:0,valuemax:100,children:n[1].members})]})]})]})}),(0,g.jsx)(u.TK,{children:(0,g.jsxs)(u.Yl,{children:[(0,g.jsx)(u.PH,{src:"2.webp",alt:"...",position:"top"}),(0,g.jsxs)(u.H7,{children:[(0,g.jsx)(u.QM,{children:"Available"}),(0,g.jsx)(u.g9,{className:"mb-1",height:"15",children:(0,g.jsx)(u.F5,{width:"100",valuemin:0,valuemax:100,children:n[2].available})}),(0,g.jsxs)(u.g9,{height:"15",children:[(0,g.jsx)(u.F5,{bgColor:"success",width:0==n[2].available?0:n[0].available/n[2].available*100,valuemin:0,valuemax:100,children:n[0].available}),(0,g.jsx)(u.F5,{bgColor:"info",width:0==n[2].available?0:n[1].available/n[2].available*100,valuemin:0,valuemax:100,children:n[1].available})]})]})]})}),(0,g.jsx)(u.TK,{children:(0,g.jsxs)(u.Yl,{children:[(0,g.jsx)(u.PH,{src:"3.webp",alt:"...",position:"top"}),(0,g.jsxs)(u.H7,{children:[(0,g.jsx)(u.QM,{children:"Assigned"}),(0,g.jsx)(u.g9,{className:"mb-1",height:"15",children:(0,g.jsx)(u.F5,{width:"100",valuemin:0,valuemax:100,children:n[2].assigned})}),(0,g.jsxs)(u.g9,{height:"15",children:[(0,g.jsx)(u.F5,{bgColor:"success",width:0==n[2].assigned?0:n[0].assigned/n[2].assigned*100,valuemin:0,valuemax:100,children:n[0].assigned}),(0,g.jsx)(u.F5,{bgColor:"info",width:0==n[2].assigned?0:n[1].assigned/n[2].assigned*100,valuemin:0,valuemax:100,children:n[1].assigned})]})]})]})}),(0,g.jsx)(u.TK,{children:(0,g.jsxs)(u.Yl,{children:[(0,g.jsx)(u.PH,{src:"4.webp",alt:"...",position:"top"}),(0,g.jsxs)(u.H7,{children:[(0,g.jsx)(u.QM,{children:"Overtime"}),(0,g.jsx)(u.g9,{className:"mb-1",height:"15",children:(0,g.jsx)(u.F5,{width:"100",valuemin:0,valuemax:100,children:n[2].overtime})}),(0,g.jsxs)(u.g9,{height:"15",children:[(0,g.jsx)(u.F5,{bgColor:"success",width:0==n[2].overtime?0:n[0].overtime/n[2].overtime*100,valuemin:0,valuemax:100,children:n[0].overtime}),(0,g.jsx)(u.F5,{bgColor:"info",width:0==n[2].overtime?0:n[1].overtime/n[2].overtime*100,valuemin:0,valuemax:100,children:n[1].overtime})]})]})]})}),(0,g.jsx)(u.TK,{children:(0,g.jsxs)(u.Yl,{children:[(0,g.jsx)(u.PH,{src:"5.jpg",alt:"...",position:"top"}),(0,g.jsxs)(u.H7,{children:[(0,g.jsx)(u.QM,{children:"Utilization"}),(0,g.jsx)(u.g9,{className:"mb-1",height:"15",children:(0,g.jsx)(u.F5,{width:n[2].utilization,valuemin:0,valuemax:100,children:n[2].utilization+"%"})}),(0,g.jsxs)(u.uZ,{children:[(0,g.jsx)(u.TK,{children:(0,g.jsx)(u.g9,{children:(0,g.jsx)(u.F5,{bgColor:"success",width:n[0].utilization,valuemin:0,valuemax:100,children:n[0].utilization+"%"})})}),(0,g.jsx)(u.TK,{children:(0,g.jsx)(u.g9,{children:(0,g.jsx)(u.F5,{bgColor:"info",width:n[1].utilization,valuemin:0,valuemax:100,children:n[1].utilization+"%"})})})]})]})]})})]}),(0,g.jsxs)(u.uZ,{className:"mt-2",children:[(0,g.jsx)(u.TK,{children:(0,g.jsx)(u.g9,{height:"15",children:(0,g.jsx)(u.F5,{bgColor:"primary",width:"100",valuemin:0,valuemax:100,children:"Total/Average"})})}),(0,g.jsx)(u.TK,{children:(0,g.jsx)(u.g9,{height:"15",children:(0,g.jsx)(u.F5,{bgColor:"success",width:"100",valuemin:0,valuemax:100,children:"Registered"})})}),(0,g.jsx)(u.TK,{children:(0,g.jsx)(u.g9,{height:"15",children:(0,g.jsx)(u.F5,{bgColor:"info",width:"100",valuemin:0,valuemax:100,children:"Assistant"})})})]}),(0,g.jsxs)(u.uZ,{children:[(0,g.jsx)(u.TK,{children:(0,g.jsx)(m.FR,{type:"line",data:{labels:c,datasets:[{label:"Average",backgroundColor:"#00f",borderColor:"#00f",pointBackgroundColor:"#00f",pointBorderColor:"#f00",data:z[2]},{label:"Registered",backgroundColor:"#0f0",borderColor:"#0f0",pointBackgroundColor:"#0f0",pointBorderColor:"#f00",data:z[0]},{label:"Assistant",backgroundColor:"#0dcaf0",borderColor:"#0dcaf0",pointBackgroundColor:"#0dcaf0",pointBorderColor:"#f00",data:z[1]}]},options:{maintainAspectRatio:!0,plugins:{legend:{display:!0}},elements:{line:{tension:.5},point:{radius:3,hitRadius:10,hoverRadius:5,hoverBorderWidth:3}}}})}),(0,g.jsx)(u.TK,{children:(0,g.jsx)(m.FR,{type:"line",data:{labels:c,datasets:[{label:"Revenue",backgroundColor:"#00f",borderColor:"#00f",pointBackgroundColor:"#00f",pointBorderColor:"#f00",data:I},{label:"Payroll",backgroundColor:"#0f0",borderColor:"#0f0",pointBackgroundColor:"#0f0",pointBorderColor:"#f00",data:A},{label:"PNL",backgroundColor:"#0dcaf0",borderColor:"#0dcaf0",pointBackgroundColor:"#0dcaf0",pointBorderColor:"#f00",data:N}]},options:{maintainAspectRatio:!0,plugins:{legend:{display:!0}},elements:{line:{tension:.5},point:{radius:3,hitRadius:10,hoverRadius:5,hoverBorderWidth:3}}}})})]})]})}}]),i}(h.Component);a.default=(0,c.$j)((function(e){return{basic:e.BasicData}}),null)(x)}}]);
//# sourceMappingURL=900.19455e41.chunk.js.map